# ASP.NET ZERO - Angular UI

See documentation: https://www.aspnetzero.com/Documents/Getting-Started-Angular

## Getting Started
1. Make sure API is running
2. Run `yarn install`
3. Run `npm run create-dynamic-bundles`
4. Run `npm start`
5. Browse to `http://localhost:4200/account/login?login=native`
6. Login with un/pw admin/123qwe
7. Browse to Administration > Visual Settings, set to theme 7

## Project Structure

**Styles**

The following style sheets are loaded in order

* `src/app/shared/core.less` - Core styles (currently empty, but could be added to)
* `src/app/shared/layout/layout.less` - Layout styles
* `src\styles.css` - Application styles file in typical Angular project structure (see: https://angular.io/guide/file-structure#application-source-files)
* `src\assets\metronic\themes\theme7\css\style.bundle.css` - Metronic's theme 7 `style.bundle.css`. This _may_ have been altered but should not have been.
* `src\assets\metronic\themes\theme7\css\styles_goddard.css` - Our copy of Metronic's theme 7 `style.bundle.css` customized.  Should not have done it this way.  Don't make further edits to this file!
* `src\assets\metronic\themes\theme7\css\styles_goddard_custom.css` - Style customizations.  This is where we should add our own custom styles!
* `src\assets\metronic\themes\theme7\css\styles_goddard_layout.css` - Theme layout customizations


## Service Proxies

Service proxies can be re-generated by running
```
npm run nswag-sh
```

**Troubleshooting**
If you get a self-signed SSL error please make sure you are running the API
under IIS Express

**ASP.NET Zero Reference**
https://docs.aspnetzero.com/en/aspnet-core-angular/v10.5.0/Infrastructure-Angular-NSwag#nswag

## Deployment

**Parsus DEV**
1. Build angular code
```
ng build --configuration=dev
```
2. Deploy via [Azure Storage](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurestorage) VSCode extension

     1. Right-click `dist` folder
     2. Select Deploy to Static Website via Azure Storage
     3. Select Pay-As-You-Go subscription
     4. Select `gsifranchiseeportal`

## Test commit to trigger build again


## Set up SSO

If you get the message: "SSO Token Expired, need to refresh from https://franchiseeportal-dev-useast-app.azurewebsites.net/.auth/me"

You need to navigate to that URL, grab the token from that location (copy the whole text) and paste it into <project>/src/.auth/me

https://franchiseeportal-dev-useast-app.azurewebsites.net/.auth/me

## Troubleshooting

### Azure build failure:
##[error]unauthorized: Invalid clientid or client secret.

Fixed by following:

https://stackoverflow.com/questions/55495223/push-docker-image-task-to-acr-fails-in-azure-unauthorized-authentication-requi

and creating a new service connection with the manual container registry inputs

## Formatting

Formatting is supported on editors with instructions below: 

It is based on a combination of editorconfig and js-beautify: https://www.npmjs.com/package/js-beautify

### VSCode

1. Install and activate the EditorConfig plugin

https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig

2. Make sure that your settings are reading from the shared workspace settings

FranchiseePortal-Website/.vscode/settings.json

## Dependencies
* [Bootstrap](https://getbootstrap.com/docs/4.5/) v4.5.3
